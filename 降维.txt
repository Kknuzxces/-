PCA降维与聚类

降维也属于预处理的步骤之一
预处理可以分为对于细胞的预处理和对于稀疏矩阵counts的预处理
##  对于细胞的预处理
   1.对于细胞种类的质控，PercentageFeatureSet() 红细胞，线粒体，核糖体
   2.对于细胞周期的质控，CellCycleScoring(),
       P.S.CellCycleScoring(),这个函数依赖data数据，所以要NormalizeData(object, verbose = FALSE) 
   3.对于双细胞液滴的质控
   4.对于细胞本身表达基因数和基因本身在各个细胞中表达的质控..subset()
##  对于counts数据的预处理
   1.Normalizedata()
   2.Findvariablefeatures()
   3.scaledata()
   4.RunPCA(),默认为50个PCs


###PC
每个主成分（Principal Component，简称 **PC**）在主成分分析（PCA）中代表了原始高维数据（如单细胞RNA测序数据）中的一个新的维度，这个维度是原始基因表达数据的线性组合，旨在捕获数据中最大程度的变异（方差）。

**具体含义**：

1. **最大方差方向**：
   - **PC1**：第一个主成分，捕获了数据中方差最大的方向，代表了数据中最主要的变异模式。
   - **PC2**：第二个主成分，捕获了与PC1正交（不相关）且具有次大方差的方向。
   - **依此类推**：后续的PC依次捕获剩余方差最大的方向，且彼此正交。

2. **基因的线性组合**：
   - 每个PC是所有基因表达的加权组合，其系数由**特征载荷（feature loadings）**决定。
   - 这些载荷表示每个基因对该PC的贡献度大小，载荷值大的基因对主成分的影响更显著。

3. **生物学解释**：
   - 通过分析每个PC的高载荷基因，研究者可以推断该PC可能代表的生物学过程或细胞状态。
   - 例如，某个PC的高载荷基因可能富集在细胞周期、免疫反应或代谢路径上，暗示该PC反映了这些生物学功能的变异。

4. **降维与数据简化**：
   - 由于单细胞数据具有高维特性（成千上万个基因），PCA通过提取主要的变异方向，将数据降维到少数几个PC上，简化了数据的复杂性。
   - 这些PC保留了大部分的数据信息，有助于后续的可视化和分析。

**在Seurat 5.0中的应用**：

- **可视化**：利用前两个或三个PC的细胞嵌入（embeddings），可以绘制二维或三维散点图，观察细胞群体的分布和分离情况。
  
- **聚类分析**：使用选定数量的PC作为输入，构建细胞间的邻近图，进行聚类分析，识别不同的细胞亚群。
  
- **特征基因识别**：通过查看每个PC的高载荷基因，识别在细胞间差异中起主要作用的基因，为生物学解释提供线索。
  
- **确定主成分数量**：根据每个PC的标准差（stdev）或通过碎石图（Elbow Plot），确定在下游分析中应使用多少个PC。

**总结**，每个PC代表了数据中一个主要的变异模式，是原始基因表达的综合特征。通过分析这些主成分，研究者可以：

- 理解细胞间的主要差异来源。
- 识别与特定生物学过程相关的基因群。
- 降低数据维度，突出最重要的信号，滤除噪声和次要变异。

**参考Seurat 5.0文档**：

- 在Seurat的PCA教程中，强调了如何解释和选择主成分：https://satijalab.org/seurat/articles/pca_vignette.html
- 文档中提到，可以使用`VizDimLoadings`函数可视化每个PC的基因载荷，帮助理解PC的生物学意义。

希望这些解释能帮助您更好地理解每个PC在PCA分析中的含义以及在Seurat 5.0中的应用。


####PCA 参数
在Seurat 5.0中，PCA降维的结果被存储在Seurat对象的`reductions`层级中。`reductions`是一个包含多个`DimReduc`对象的列表，每个`DimReduc`对象对应一种降维方法（例如，PCA、t-SNE、UMAP）。在`DimReduc`对象下，有多个子层级，每个子层级都存储了特定的降维信息。以下是对PCA结果中各个子层级的详细解释：

1. **embeddings（cell.embeddings）**：
   - **含义**：这是一个矩阵，存储了每个细胞在降维空间中的坐标。
   - **结构**：行表示细胞，列表示主成分（PC）。
   - **用途**：用于可视化和后续分析，例如聚类和邻近图构建。

2. **loadings（feature.loadings）**：
   - **含义**：这是一个矩阵，存储了每个基因在主成分上的载荷（贡献度）。
   - **结构**：行表示基因，列表示主成分（PC）。
   - **用途**：用于理解哪些基因对特定的主成分贡献最大，有助于生物学解释。

3. **stdev（标准差）**：
   - **含义**：这是一个向量，存储了每个主成分的标准差，即每个PC所捕获的方差量。
   - **用途**：用于确定保留多少个主成分（例如，通过绘制碎石图）。

4. **key（键值）**：
   - **含义**：这是一个字符串，用于在列名中标识降维方法，例如“PC_”。
   - **用途**：确保在数据框或矩阵中，主成分的列名具有一致的前缀，方便识别。

5. **misc（杂项）**：
   - **含义**：这是一个列表，存储了与降维相关的其他辅助信息。
   - **用途**：可以包含特定分析中需要的额外数据，例如参数设置或中间计算结果。

6. **feature.loadings.projected**（如果存在）：
   - **含义**：当将额外的基因投影到已计算的PCA空间时，存储这些基因的载荷。
   - **用途**：用于在初始PCA之外添加新的基因信息。

7. **jackstraw信息**（如果进行了JackStraw分析）：
   - **含义**：存储了JackStraw方法的结果，用于评估主成分的显著性。
   - **用途**：帮助确定哪些主成分在统计上显著，指导主成分的选择。

8. **邻近图信息**（如果相关）：
   - **含义**：如果使用PCA结果构建了邻近图，则相关信息可能存储在这里。
   - **用途**：用于下游的聚类分析和可视化。

**总结**，在Seurat 5.0的`reductions`层级下，每个`DimReduc`对象（如`pca`）包含了丰富的降维信息，各个子层级协同作用，帮助研究者理解和利用降维结果进行后续的单细胞数据分析。